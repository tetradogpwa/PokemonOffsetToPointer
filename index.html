<!DOCTYPE html>
<html lang="es">

<head>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script async src="https://cdn.jsdelivr.net/npm/pwacompat@2.0.9/pwacompat.min.js"
        integrity="sha384-VcI6S+HIsE80FVM1jgbd6WDFhzKYA0PecD/LcIyMQpT4fMJdijBh0I7Iblaacawc"
        crossorigin="anonymous"></script>
    <style type="text/css">
        html,
        body {
            overscroll-behavior-y: contain;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        .container {
            margin-top: 10px;
        }
    </style>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/png" sizes="512x512" href="icon.png">
    <link rel="apple-touch-icon" type="image/png" sizes="512x512" href="icon.png">
    <script src="pokemonOffsetToPointer.js"></script>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-3">
                <p>Offset</p>
            </div>
            <div class="col-5">
                <input id="inpOffset" placeholder="Offset">
            </div>
            <div class="col-2">
                <input type="button" id="btnPasteOffset" value="Pegar">
            </div>
            <div class="col-2">
                <input type="button" id="btnCopyOffset" value="Copiar">
            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <p>Pointer</p>
            </div>
            <div class="col-5">
                <input id="inpPointer" placeholder="Pointer">
            </div>
            <div class="col-2">
                <input type="button" id="btnPastePointer" value="Pegar">
            </div>
            <div class="col-2">
                <input type="button" id="btnCopyPointer" value="Copiar">
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <input type="button" id="btnReset" value="Reset">
            </div>
        </div>
    </div>

    <script>
        window.onload = () => {
            inicializar();

            document.getElementById("btnPasteOffset").onclick = PegarOffset;
            document.getElementById("btnCopyOffset").onclick = CopiarOffset;
            document.getElementById("btnPastePointer").onclick = PegarPointer;
            document.getElementById("btnCopyPointer").onclick = CopiarPointer;
            document.getElementById("btnReset").onclick = Reset;
        };

        function inicializar() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/PokemonOffsetToPointer/sw.js');
            }
            CargarCampos();
        }

        function GenerarPointer() {
            var offset = document.getElementById("inpOffset").value;
            if (offset) {
                document.getElementById("inpPointer").value = CalculaPointer(offset);
                GuardaCampos();
            }
        }

        function GenerarOffset() {
            var pointer = document.getElementById("inpPointer").value;
            if (pointer) {
                document.getElementById("inpOffset").value = CalculaOffset(pointer);
                GuardaCampos();
            }
        }

        function CopiarOffset() {
            CopiarToClipBoard("inpOffset");
        }

        function CopiarPointer() {
            CopiarToClipBoard("inpPointer");
        }

        function PegarOffset() {
            PegarToClipBoard().then(paste => {
                document.getElementById("inpOffset").value = paste;
                GenerarPointer();
            }).catch(() => alert("Se ha bloqueado el botón Pegar. Desbloquéalo para poder usarlo."));
        }

        function PegarPointer() {
            PegarToClipBoard().then(paste => {
                document.getElementById("inpPointer").value = paste;
                GenerarOffset();
            }).catch(() => alert("Se ha bloqueado el botón Pegar. Desbloquéalo para poder usarlo."));
        }

        function CopiarToClipBoard(inputId) {
            var copyText = document.getElementById(inputId);
            navigator.clipboard.writeText(copyText.value);
        }

        function Reset() {
            document.getElementById("inpOffset").value = "";
            document.getElementById("inpPointer").value = "";
            GuardaCampos();
        }

        function CargarCampos() {
            document.getElementById("inpOffset").value = localStorage.getItem("offset") || "";
            GenerarPointer();
        }

        function GuardaCampos() {
            localStorage.setItem("offset", document.getElementById("inpOffset").value);
        }
    </script>
</body>

</html>
